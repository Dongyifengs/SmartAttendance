/* empty css                  */import{O as e}from"./index-DjBO542e.js";import{Z as a}from"./index-ThND04tc.js";import{v as l,r as s,c as o,o as t,x as r,B as n,U as u,J as d,H as i,aa as c,O as m,K as p,I as v,y as f,P as g,a2 as S,u as h,M as w}from"./vue-vendor-CoPnbFnN.js";import{E as I,a as b,b as y,c as O,d as _,e as A,f as U,u as C,l as N,g as V,h as x}from"./element-plus-tx2s2pn9.js";import{r as T,_ as k}from"./index-30FeaZnB.js";import"./utils-BuH06i2U.js";const E={class:"mainBox"},M={class:"loginContainer"},J={class:"brand"},j={key:0,class:"build-info-tag"},H=["href"],K=144e5,L=k(l({__name:"PageLogin",setup(l){const k=s(!1),L=()=>{k.value=!0,setTimeout(()=>{k.value=!1},1e3)},Z=o(()=>({date:"2025-11-13",hash:"f7ede28b",commitUrl:"https://github.com/Dongyifengs/SmartAttendance/commit/f7ede28b9359420e4cf1d4e99f98968f6d992b52"})),F=s("zhkqLogin"),P=s({username:"",password:"",deviceId:""}),Q=s({username:"",password:""}),z=()=>(new Date).getTime();function D(){!function(){const e=Number(localStorage.getItem("SA-ZHKQ-TIMESTAMP")||"0");z()-e>K&&R(1)}(),function(){const e=Number(localStorage.getItem("SA-OC-TIMESTAMP")||"0");z()-e>K&&R(2)}()}function R(l){if(1==l){if(!(P.value.username&&P.value.password&&P.value.deviceId))return void b.warning("请填写完整信息！");a({userid:P.value.username,userpwd:P.value.password,client_local_id:P.value.deviceId}).then(async e=>{"1"===e.state?(b.success("智慧考勤登录成功！"),localStorage.setItem("SA-ZHKQ-USERINFO",JSON.stringify(e)),localStorage.setItem("SA-ZHKQ-TIMESTAMP",z().toString()),localStorage.setItem("SA-ZHKQ-ACCOUNT",JSON.stringify({username:P.value.username,password:P.value.password,deviceId:P.value.deviceId})),localStorage.getItem("SA-OC-USERINFO")?await T.push("/dev/home"):F.value="ocLogin"):b.error("智慧考勤登录失败："+e.info)})}else if(2==l){if(!Q.value.username||!Q.value.password)return void b.warning("请填写完整信息！");e(Q.value.username,Q.value.password).then(async e=>{if(200===e.code){b.success("登录成功！");const a=JSON.parse(JSON.stringify(e));a.data&&(a.data.backUrl="",a.data.logoUrl=""),localStorage.setItem("SA-OC-USERINFO",JSON.stringify(a)),localStorage.setItem("SA-OC-TIMESTAMP",z().toString()),localStorage.setItem("SA-OC-ACCOUNT",JSON.stringify({username:Q.value.username,password:Q.value.password})),localStorage.getItem("SA-ZHKQ-USERINFO")?await T.push("/dev/home"):F.value="zhkqLogin"}else b.error("一卡通登录失败："+e.msg)})}}return t(()=>{!function(){const e=localStorage.getItem("SA-ZHKQ-ACCOUNT");if(e)try{const a=JSON.parse(e);P.value.username=a.username||"",P.value.password=a.password||"",P.value.deviceId=a.deviceId||""}catch(l){}else P.value.username="",P.value.password="",P.value.deviceId="";const a=localStorage.getItem("SA-OC-ACCOUNT");if(a)try{const e=JSON.parse(a);Q.value.username=e.username||"",Q.value.password=e.password||""}catch(l){}else Q.value.username="",Q.value.password=""}(),D()}),(e,a)=>{const l=y,s=U,o=A,t=x,b=_,T=O,K=I;return f(),r("div",E,[n("div",M,[n("div",J,[(f(),r(i,null,c("欢迎使用SmartAttendance",(e,a)=>n("span",{key:a,style:g({animationDelay:.08*a+"s"}),class:"brand-char"},m(e),5)),64)),Z.value?(f(),r("div",j,[n("span",null,"在"+m(Z.value.date)+"编译",1),a[10]||(a[10]=n("span",null,"(",-1)),n("a",{href:Z.value.commitUrl,class:"commit-hash-link",target:"_blank"},m(Z.value.hash),9,H),a[11]||(a[11]=n("span",null,")",-1))])):(f(),d(l,{key:1,type:"danger"},{default:p(()=>[S(m(h("")),1)]),_:1}))]),u(K,{modelValue:F.value,"onUpdate:modelValue":a[9]||(a[9]=e=>F.value=e),class:v(["ocLogin"===F.value?"dy_item":"","loginTabs"]),type:"card",onTabChange:L},{default:p(()=>[u(T,{label:"智慧考勤登录",name:"zhkqLogin"},{default:p(()=>[n("div",{class:v([{"animate-enter":k.value},"tab-content"])},[u(b,{model:P.value,class:"loginForm",onSubmit:a[4]||(a[4]=w(e=>R(1),["prevent"]))},{default:p(()=>[u(o,{prop:"username"},{default:p(()=>[u(s,{modelValue:P.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>P.value.username=e),"prefix-icon":h(C),class:"form-input",clearable:"",placeholder:"请输入学号"},null,8,["modelValue","prefix-icon"])]),_:1}),u(o,{prop:"password"},{default:p(()=>[u(s,{modelValue:P.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>P.value.password=e),"prefix-icon":h(N),class:"form-input",clearable:"",placeholder:"请输入密码","show-password":"",type:"password"},null,8,["modelValue","prefix-icon"])]),_:1}),a[13]||(a[13]=n("div",{class:"build-info-tag",style:{"text-align":"center"}},[n("span",null,"手机拨号键"),n("a",{class:"commit-hash-link",href:"javascript:void(0)"},m("*#06#")),n("span",null,"的IMEI1")],-1)),u(o,{prop:"deviceId"},{default:p(()=>[u(s,{modelValue:P.value.deviceId,"onUpdate:modelValue":a[2]||(a[2]=e=>P.value.deviceId=e),"prefix-icon":h(V),class:"form-input",clearable:"",placeholder:"请输入设备ID"},null,8,["modelValue","prefix-icon"])]),_:1}),u(t,{class:"custom_btn",round:"",size:"large",style:{width:"100%"},type:"primary",onClick:a[3]||(a[3]=e=>R(1))},{default:p(()=>[...a[12]||(a[12]=[S(" 登录智慧考勤 ",-1)])]),_:1})]),_:1},8,["model"])],2)]),_:1}),u(T,{label:"一卡通账号登录",name:"ocLogin"},{default:p(()=>[n("div",{class:v([{"animate-enter":k.value},"tab-content"])},[u(b,{model:Q.value,class:"loginForm",onSubmit:a[8]||(a[8]=w(e=>R(2),["prevent"]))},{default:p(()=>[u(o,{prop:"username"},{default:p(()=>[u(s,{modelValue:Q.value.username,"onUpdate:modelValue":a[5]||(a[5]=e=>Q.value.username=e),"prefix-icon":h(C),class:"form-input",clearable:"",placeholder:"请输入考生号"},null,8,["modelValue","prefix-icon"])]),_:1}),u(o,{prop:"password"},{default:p(()=>[u(s,{modelValue:Q.value.password,"onUpdate:modelValue":a[6]||(a[6]=e=>Q.value.password=e),"prefix-icon":h(N),class:"form-input",clearable:"",placeholder:"请输入密码","show-password":"",type:"password"},null,8,["modelValue","prefix-icon"])]),_:1}),u(t,{class:"custom_btn",round:"",size:"large",style:{width:"100%"},type:"primary",onClick:a[7]||(a[7]=e=>R(2))},{default:p(()=>[...a[14]||(a[14]=[S(" 登录一卡通 ",-1)])]),_:1})]),_:1},8,["model"])],2)]),_:1})]),_:1},8,["modelValue","class"])])])}}}),[["__scopeId","data-v-7c2c5c61"]]);export{L as default};
